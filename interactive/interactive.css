/* ============================================================
   PodCube Interactive Engine v3.0 — Stylesheet
   ============================================================ */

/* ── 1. MENU GRID ──────────────────────────────────────────── */
.game-menu-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 15px;
}

.game-card {
    border: 3px double var(--primary);
    border-radius: 5px;
    background: #fff;
    padding: 20px;
    cursor: pointer;
    transition: all 0.15s ease;
    display: flex;
    flex-direction: column;
    gap: 10px;
    overflow: hidden;
}

@media (hover: hover) {
    .game-card:hover {
        background: var(--primary-dim);
        transform: translateY(-3px);
        box-shadow: 4px 4px 0 rgba(23, 104, 218, 0.15);
    }
}

.game-card-meta { font-family:"Fustat"; font-size:10px; font-weight:700; color:#bbb; text-transform:uppercase; letter-spacing:0.08em; }
.game-card-title { font-family:"Libertinus Math", serif; font-size:1.4em; font-weight:700; color:var(--primary); line-height:1.1; }
.game-card-score { margin-top:auto; font-family:"Fustat"; font-weight:700; font-size:11px; color:var(--primary-dark); background:#fff; border:1px solid var(--primary-dim); padding:4px 8px; align-self:flex-start; }


/* ── 2. STAGE & HUD ────────────────────────────────────────── */
.game-stage { 
    display: none; 
    width: 100%; 
    max-width: 680px;
    margin: 0 auto; 
    user-select: none; 
}
.game-stage.active { 
    display: block; 
    animation: fadeStage 0.25s ease; 
}

@keyframes fadeStage {
    from { opacity: 0; transform: translateY(6px); }
    to   { opacity: 1; transform: translateY(0); }
}

.game-navbar {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 3px double var(--primary);
}

.pc-game-container {
    display: flex;
    flex-direction: column;
    margin-bottom: 10px;
}

.pc-game-hud {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    padding-bottom: 8px;
    margin-bottom: 15px;
    border-bottom: 1px dashed var(--primary-dim);
}

.pc-hud-cell { display: flex; flex-direction: column; }
.pc-hud-cell:last-child { text-align: right; align-items: flex-end; }
.pc-hud-label { font-family:"Fustat"; font-size:9px; font-weight:700; color:#ccc; text-transform:uppercase; letter-spacing:0.08em; display:block; }
.pc-hud-val   { font-family:"Libertinus Math"; font-size:20px; font-weight:700; color:var(--primary); line-height:1; }


/* ── 3. GAME BOARD (CANVAS) ────────────────────────────────── */
.pc-game-board {
    position: relative;
    border: 3px double var(--primary);
    overflow: hidden;
    aspect-ratio: 4 / 3; /* Enforces strict scaling without stretching */
    user-select: none;
    -webkit-user-select: none;
    border-radius: 5px;
}

.pc-game-canvas {
    display: block;
    width: 100%;
    height: 100%;
    image-rendering: pixelated; 
}

.pc-layer-dom {
    position: absolute;
    top: 0;
    left: 0;
    width: 400px;
    height: 300px;
    transform-origin: top left;
    pointer-events: none;
}


/* ── 4. SCROLL LOCKING (ONLY WHEN GAME RUNS) ───────────────── */
#pc-machine-view.pc-game-active {
    overscroll-behavior: none; /* Stops iOS rubber-banding */
}

/* Explicitly target the board and the controls to block swipe-to-scroll ONLY while playing */
#pc-machine-view.pc-game-active .pc-game-board,
#pc-machine-view.pc-game-active .pc-controls-strip {
    touch-action: none;
    user-select: none;
}


/* ── 5. INPUT CONTROLS (MOBILE DEFAULT) ────────────────────── */
.pc-controls-strip {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 15px;
    padding: 15px;
    margin-top: 15px;
    margin-bottom: 30px; /* Safe space above Explorer bottom nav */
    border: 1px solid var(--primary);
    border-radius: 15px;
    background: var(--bg-body);
    user-select: none;
    -webkit-user-select: none;
    touch-action: manipulation; /* Allows page scrolling before game starts */
}

.pc-controls-strip button, .pc-dpad-center {
    border-radius: 10px;
}

/* This might be stupid
.pc-controls-strip::before {
    content: "Input Module";
    position: absolute;
    bottom: -9px; 
    top: auto;
    left: 12px;
    background: var(--bg-body);
    padding: 0 6px;
    font-family: "Fustat", sans-serif;
    font-size: 9px;
    font-weight: 700;
    color: var(--primary);
    text-transform: uppercase;
    letter-spacing: 0.08em;
} */

.pc-controls-helper {
    display: none; /* Hidden on mobile to save precious horizontal space */
    text-align: center;
    font-family: "Fustat", sans-serif;
    font-size: 10px;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    line-height: 1.4;
}


/* ── 6. DESKTOP GRID LAYOUT ────────────────────────────────── */
@media (min-width: 768px) {
    .pc-controls-helper {
        display: flex;
        flex-direction: column;
        align-self: flex-end;
        gap: 5px;
    }
    
    .pc-game-container {
        display: grid;
        grid-template-columns: 1fr 200px; 
        grid-template-rows: auto 1fr;
        gap: 0 20px;
        align-items: start;
    }

    .pc-game-hud { grid-column: 1 / -1; }
    
    .pc-game-board { grid-column: 1; grid-row: 2; }

    .pc-controls-strip {
        grid-column: 2;
        grid-row: 2;
        margin: 0;
        padding: 0px;
        flex-direction: column;
        justify-content: center;
        height: 100%;
        box-sizing: border-box;
    }

    .pc-action-cluster { width: 100%; justify-content: center; gap: 15px; }
    .pc-dpad { align-self: center; }
}


/* ── 7. BUTTONS & UI COMPONENTS ────────────────────────────── */

/* Action Cluster (Q & E) */
.pc-action-cluster {
    display: flex;
    align-items: center; /* Changed from flex-end so they balance from the middle */
    gap: 12px; /* Close enough to comfortably slide a thumb */
    touch-action: none;
}

.pc-action-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
}

/* ── The Classic Handheld Slant ── */
.pc-action-item:nth-child(1) {
    margin-bottom: 60px; /* Pushes the Q button up */
}

.pc-action-item:nth-child(2) {
    margin-top: 60px; /* Pushes the E button down */
}

.pc-action-key {
    font-family: "Fustat", sans-serif;
    font-size: 9px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--primary-dark);
}

.pc-action-btn {
    width: 64px; height: 64px; 
    display: flex; align-items: center; justify-content: center;
    border: 1px solid var(--primary);
    background: var(--bg-panel); color: var(--primary);
    font-family: "Fustat", sans-serif; font-size: 18px; font-weight: 700;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    transition: background 80ms, color 80ms;
}

/* D-Pad Grid */
.pc-dpad {
    display: grid;
    grid-template-areas:
        ". up ."
        "left center right"
        ". down .";
    grid-template-columns: repeat(3, 54px); 
    grid-template-rows:    repeat(3, 54px); 
    gap: 2px;
    touch-action: none;
    flex-shrink: 0;
}

.pc-dpad-up     { grid-area: up; }
.pc-dpad-left   { grid-area: left; }
.pc-dpad-center { grid-area: center; background: var(--primary-dim); border: 1px solid var(--primary-dim); pointer-events: none; }
.pc-dpad-right  { grid-area: right; }
.pc-dpad-down   { grid-area: down; }

.pc-dpad-btn {
    width: 100%; height: 100%;
    display: flex; align-items: center; justify-content: center;
    border: 1px solid var(--primary);
    background: var(--bg-panel); color: var(--primary);
    font-size: 12px; cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    transition: background 80ms, color 80ms;
}

/* Button Active States (Applies to both Actions and D-Pad) */
.pc-action-btn:active, .pc-action-btn.pc-active,
.pc-dpad-btn:active,   .pc-dpad-btn.pc-active {
    background: var(--primary);
    color: #fff;
    border-color: var(--primary-dark);
}

@media (hover: hover) {
    .pc-action-btn:hover, .pc-dpad-btn:hover { background: var(--primary-dim); }
}

/* Base UI Buttons (Start, Cancel) */
.pc-btn {
    border: 1px solid var(--primary); background: var(--bg-body); color: var(--primary);
    font-family: "Fustat"; font-weight: 700; text-transform: uppercase;
    font-size: 11px; padding: 10px 20px; cursor: pointer;
    transition: transform 0.08s; pointer-events: auto;
}
.pc-btn:active { transform: scale(0.95); }
.pc-btn.primary { background: var(--primary); color: var(--bg-body); border-color: var(--primary-dark); }
.pc-btn.danger { border-color: #e53e3e; color: #e53e3e; }

/* Overlays & DOM Engine */
.pc-overlay {
    position: absolute; inset: 0;
    background: rgba(255,255,255,0.96); backdrop-filter: blur(3px);
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    gap: 12px; padding: 24px; text-align: center;
    z-index: 20; transition: opacity 0.2s ease;
    visibility: visible;
}
.pc-overlay.hidden { opacity: 0; pointer-events: none; visibility: hidden; }
.pc-text-title { font-family: "Libertinus Math"; font-size: 22px; font-weight: 700; color: var(--primary); }
.pc-text-body { font-family: "Fustat"; font-size: 12px; color: #555; white-space: pre-wrap;}
.pc-ui-col { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; pointer-events: auto; }


/* ── Narrow phone adjustments (<360px) ─────────────────────── */
@media (max-width: 360px) {
    .pc-dpad { grid-template-columns: repeat(3, 46px); grid-template-rows: repeat(3, 46px); }
    .pc-action-btn { width: 54px; height: 54px; font-size: 15px; }
    .pc-controls-strip { padding: 10px 12px; gap: 10px; }
}